<!doctype html>

<html lang="en">

<head>
    <meta charset="utf-8">

    <title>Agora Analytica</title>
    <meta name="description" content="">
    <meta name="author" content="">


    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='main.css') }}">

    <style>
    #graph svg {
        background: radial-gradient(circle, rgba(233,233,233,1) 0%, rgba(205,205,205,1) 83%, rgba(149,149,149,1) 100%);
        display: block;
    }

    #imperium text {
        fill:#fff;
        font-family:serif;
        filter:drop-shadow( 0 0 5px rgba(0,0,0,0.692) );
    }

    .links line {
        stroke: rgba(0, 0, 0, 0.692);
        stroke-opacity: 0.6;
    }

    .nodes circle {
        stroke-width: 1.5px;
    }

    .nodes .node {
      transition: all 0.7s;
      filter: grayscale(0) blur(0) drop-shadow( 0 1px 5px rgba(0,0,0,0.233) );
    }

    .nodes:hover .node {
      filter: grayscale(100%) blur(1px) drop-shadow( 0 1px 5px rgba(0,0,0,0.233) );

    }
    .nodes:hover .node:hover {
      filter: grayscale(0) blur(0)  drop-shadow( 0 1px 5px rgba(0,0,0,0.233) );
    }
    .nodes:hover .node.active {
      filter:grayscale(50%) blur(0) drop-shadow( 0 1px 5px rgba(0,0,0,0.233) );
    }
    .node .topic {
      transition: all 0.7s;
      font-size:0.3em;
      opacity: 0;
    }

    .node:hover .topic {
      opacity:1;
    } 

    .nodes .node-info {
      display: none;
      z-index: 1000;
    }
    .nodes .active .node-info {
      display: block;
    }


    .nodes .active .node-info {
      display: block;
    }
    </style>

</head>

<body>

    <nav class="navbar navbar-expand-sm bg-dark navbar-dark">
        <a class=" navbar-brand" href="#">
        <img src="{{ url_for('static', filename='logo.png') }}" alt="logo" style="width:100px;">
        </a>

        <div class="navbar-collapse" id="main-navigation">
            <ul class="navbar-nav">

                <li class="nav-item dropdown">
                    <a href="#" select id = "dropdownVaalip" class="nav-link dropdown-toggle" data-toggle="dropdown" >Vaalipiirit</a>
                    <ul class="dropdown-menu">
                        <li><a href="#" class="small" data-value="option1" tabIndex="-1">&nbsp;<input
                                    type="checkbox" />&nbsp;Helsinki</a></li>
                        <li><a href="#" class="small" data-value="option2" tabIndex="-1">&nbsp;<input
                                    type="checkbox" />&nbsp;Uusimaa</a></li>
                        <li><a href="#" class="small" data-value="option3" tabIndex="-1">&nbsp;<input
                                    type="checkbox" />&nbsp;Varsinais-Suomi</a></li>
                        <li><a href="#" class="small" data-value="option4" tabIndex="-1">&nbsp;<input
                                    type="checkbox" />&nbsp;Satakunta</a></li>
                        <li><a href="#" class="small" data-value="option5" tabIndex="-1">&nbsp;<input
                                    type="checkbox" />&nbsp;Ahvenanmaa</a></li>
                        <li><a href="#" class="small" data-value="option6" tabIndex="-1">&nbsp;<input
                                    type="checkbox" />&nbsp;Häme</a></li>
                        <li><a href="#" class="small" data-value="option7" tabIndex="-1">&nbsp;<input
                                    type="checkbox" />&nbsp;Pirkanmaa</a></li>
                        <li><a href="#" class="small" data-value="option8" tabIndex="-1">&nbsp;<input
                                    type="checkbox" />&nbsp;Kaakkois-Suomi</a></li>
                        <li><a href="#" class="small" data-value="option9" tabIndex="-1">&nbsp;<input
                                    type="checkbox" />&nbsp;Savo-Karjala</a></li>
                        <li><a href="#" class="small" data-value="option10" tabIndex="-1">&nbsp;<input
                                    type="checkbox" />&nbsp;Vaasa</a></li>
                        <li><a href="#" class="small" data-value="option11" tabIndex="-1">&nbsp;<input
                                    type="checkbox" />&nbsp;Keski-Suomi</a></li>
                        <li><a href="#" class="small" data-value="option12" tabIndex="-1">&nbsp;<input
                                    type="checkbox" />&nbsp;Oulu</a></li>
                        <li><a href="#" class="small" data-value="option13" tabIndex="-1">&nbsp;<input
                                    type="checkbox" />&nbsp;Lappi</a></li>
                    </ul>
                </li>

                <li class="nav-item dropdown">
                    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Puolueet</a>
                    <ul class="dropdown-menu">
                        <li><a href="#" class="small" data-value="option1" tabIndex="-1">&nbsp;<input
                                    type="checkbox" />&nbsp;Suomen Sosialidemokraattinen Puolue</a></li>
                        <li><a href="#" class="small" data-value="option2" tabIndex="-1">&nbsp;<input
                                    type="checkbox" />&nbsp;Perussuomalaiset</a></li>
                        <li><a href="#" class="small" data-value="option3" tabIndex="-1">&nbsp;<input
                                    type="checkbox" />&nbsp;Kansallinen Kokoomus</a></li>
                        <li><a href="#" class="small" data-value="option4" tabIndex="-1">&nbsp;<input
                                    type="checkbox" />&nbsp;Suomen Keskusta</a></li>
                        <li><a href="#" class="small" data-value="option5" tabIndex="-1">&nbsp;<input
                                    type="checkbox" />&nbsp;Vihreä liitto</a></li>
                        <li><a href="#" class="small" data-value="option6" tabIndex="-1">&nbsp;<input
                                    type="checkbox" />&nbsp;Vasemmistoliitto</a></li>
                        <li><a href="#" class="small" data-value="option7" tabIndex="-1">&nbsp;<input
                                    type="checkbox" />&nbsp;Suomen ruotsalainen kansanpuolue</a></li>
                        <li><a href="#" class="small" data-value="option8" tabIndex="-1">&nbsp;<input
                                    type="checkbox" />&nbsp;Suomen Kristillisdemokraatit</a></li>
                        <li><a href="#" class="small" data-value="option9" tabIndex="-1">&nbsp;<input
                                    type="checkbox" />&nbsp;Liike Nyt</a></li>
                        <li><a href="#" class="small" data-value="option10" tabIndex="-1">&nbsp;<input
                                    type="checkbox" />&nbsp;Eläinoikeuspuolue</a></li>
                        <li><a href="#" class="small" data-value="option11" tabIndex="-1">&nbsp;<input
                                    type="checkbox" />&nbsp;Feministinen puolue</a></li>
                        <li><a href="#" class="small" data-value="option12" tabIndex="-1">&nbsp;<input
                                    type="checkbox" />&nbsp;Itsenäisyyspuolue</a></li>
                        <li><a href="#" class="small" data-value="option13" tabIndex="-1">&nbsp;<input
                                    type="checkbox" />&nbsp;Kansalaispuolue</a></li>
                        <li><a href="#" class="small" data-value="option14" tabIndex="-1">&nbsp;<input
                                    type="checkbox" />&nbsp;Liberaalipuolue</a></li>
                        <li><a href="#" class="small" data-value="option15" tabIndex="-1">&nbsp;<input
                                    type="checkbox" />&nbsp;Piraattipuolue</a></li>
                        <li><a href="#" class="small" data-value="option16" tabIndex="-1">&nbsp;<input
                                    type="checkbox" />&nbsp;Seitsemän tähden liike</a></li>
                        <li><a href="#" class="small" data-value="option17" tabIndex="-1">&nbsp;<input
                                    type="checkbox" />&nbsp;Sininen tulevaisuus</a></li>
                        <li><a href="#" class="small" data-value="option18" tabIndex="-1">&nbsp;<input
                                    type="checkbox" />&nbsp;Suomen Kansa Ensin</a></li>
                    </ul>
                </li>

                <button type="button" class="btn btn-secondary" type="submit" onclick="refreshGraph()">Hae</button>
        </div>
    </nav>

    <div id="graph">
        <svg>
            <g id="imperium">
                <text>AGORA ANALYTICA</text>
                <line x1="-6em" y1="0" x2="6em" y2="0" stroke-width=1 stroke="white" />
                <line x1="-6em" y1="0" x2="6em" y2="0" stroke-width=1 stroke="white" />
            </g>
        </svg>
    </div>
<script>
(function() {
    {# Set graph size early #}
    const width = parseInt(window.innerWidth),
          height = parseInt(window.innerHeight);
    let svg = document.querySelector("#graph svg");
    svg.setAttribute('width', width);
    svg.setAttribute('height', height);

    let g = svg.querySelector("#imperium");
    let t = g.querySelector("text");
    const w = t.getBBox();

    const _w = w.width/2;
    const _h = w.height/2;

    t.setAttribute("x", -_w);
    t.setAttribute("y", -_h);

    let ls = g.getElementsByTagName("line");
    for(e of ls) {
        e.setAttribute("x1", -_w - _w/20);
        e.setAttribute("x2", _w + _w/20);
    }
    ls[0].setAttribute("y1", -_h + _h/4);
    ls[0].setAttribute("y2", -_h + _h/4);

    ls[1].setAttribute("y1", -_h*2 - _h /3);
    ls[1].setAttribute("y2", -_h*2 - _h /3);

    const r = Math.min(width/w.width, height/w.height);

    g.setAttribute("transform", "translate("+width/2+","+height/2+") scale("+r/3+")");
    g.setAttribute("y", parseInt(height / 2))
})();

</script>

<script src="https://d3js.org/d3.v4.js"></script>
<script src="{{url_for('static', filename='graph.js')}}"></script>
<script>
var nodes = [],
    links = [],
    topics = [],
    parties = [];

var default_image = {{url_for("static", filename="default-person.png")|tojson|safe}}

d3.json('{{url_for(".data_parties")}}', function(data) {
    parties = data;
    run();
});
d3.json('{{url_for(".data_nodes")}}', function(data) {
    nodes = data;
    run();
});
d3.json('{{url_for(".data_links")}}', function(data) { process_links(data); run(); });
    </script>

<footer class="page-footer bg-dark text-white">
        <div class="footer-copyright text-center color"> Agora Analytica 2019 -
            <a href="https://opensource.org/licenses/MIT"> MIT-lisenssi</a>
        </div>
</footer>
    
    <script type = "text/javascript" src="{{ url_for('static', filename='main.js') }}"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>
</body>

</html>